/*
 * Copyright (c) 2025 u-blox AG
 *
 * SPDX-License-Identifier: Apache-2.0
 */

#include "ubx_evk_iris_w1_rw612-pinctrl.dtsi"
#include <zephyr/dt-bindings/input/input-event-codes.h>

/ {
	model = "u-blox evk_iris_w1 rw612";
	compatible = "u-blox,ubx_evk_iris_w1_rw612";
	aliases {
		usart-0 = &flexcomm3;
		led0 = &rgb_red;
		led1 = &rgb_green;
		led2 = &rgb_blue;
		sw0 = &user_button_0;
		sw1 = &user_button_1;
	};

	chosen {
		zephyr,sram = &sram_data;
		zephyr,flash = &w25q512jvfiq;
		zephyr,console = &flexcomm3;
		zephyr,shell-uart = &flexcomm3;
		zephyr,flash-controller = &w25q512jvfiq;
		zephyr,code-partition = &slot0_partition;
		zephyr,uart-mcumgr = &flexcomm3;
	};

	// IRIS-W1 RGB
	rgb_leds {
		compatible = "gpio-leds";
		rgb_blue: led_1 {
			gpios = < &hsgpio1 0xa GPIO_ACTIVE_LOW>;
			label = "IRIS RGB_BLUE";
		};
		rgb_green: led_2 {
			gpios = < &hsgpio1 0xb GPIO_ACTIVE_LOW >;
			label = "IRIS RGB_GREEN";
		};
		rgb_red: led_3 {
			gpios = < &hsgpio1 0xc GPIO_ACTIVE_LOW >;
			label = "IRIS RGB_RED";
		};
	};

	sw {
		compatible = "gpio-keys";
		user_button_0: sw_1 {
			label = "IRIS SWITCH_1";  // GPIO45
			gpios = < &hsgpio1 0xd GPIO_ACTIVE_LOW >;
			zephyr,code = < 0x2 >;
		};

		user_button_1: sw_2 {
			label = "IRIS SWITCH_2";  // GPIO51
			gpios = < &hsgpio1 0x13 GPIO_ACTIVE_LOW >;
			zephyr,code = < 0x3 >;
		};
	};

};

&flexcomm3 {
	compatible = "nxp,lpc-usart";
	status = "okay";
	current-speed = <115200>;
	pinctrl-0 = <&pinmux_flexcomm3_usart>;
	pinctrl-names = "default";
};

&flexcomm0 {
	compatible = "nxp,lpc-usart";
	status = "disabled";
	current-speed = <115200>;
	pinctrl-0 = <&pinmux_flexcomm0_usart>;
	pinctrl-names = "default";
};

&hsgpio0 {
	status = "okay";
};

&flexspi {
	status = "okay";
	ahb-bufferable;
	ahb-prefetch;
	ahb-cacheable;
	ahb-read-addr-opt;
	ahb-boundary = "1024";
	rx-clock-source = <1>;
	rx-clock-source-b = <1>;
	/* Winbond external flash */
	w25q512jvfiq: w25q512jvfiq@0 {
		compatible = "nxp,imx-flexspi-nor";
		reg = <0>;
		size = <DT_SIZE_M(64 * 8)>;
		status = "okay";
		erase-block-size = <4096>;
		write-block-size = <1>;
		spi-max-frequency = <104000000>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			boot_partition: partition@0 {
				label = "mcuboot";
				reg = <0x00000000 DT_SIZE_K(128)>;
			};
			/* The MCUBoot swap-move algorithm uses the last 2 sectors
			 * of the primary slot0 for swap status and move.
			 */
			slot0_partition: partition@20000 {
				label = "image-0";
				reg = <0x00020000 (DT_SIZE_M(3) + DT_SIZE_K(2 * 4))>;
			};
			slot1_partition: partition@323000 {
				label = "image-1";
				reg = <0x00323000 DT_SIZE_M(3)>;
			};
			storage_partition: partition@623000 {
				label = "storage";
				reg = <0x00623000 (DT_SIZE_M(58) - DT_SIZE_K(136))>;
			};
		};
	};
	aps6404l: aps6404l@2 {
			compatible = "nxp,imx-flexspi-aps6404l";
			/* APS6404L is 8MB, 64MBit pSRAM */
			size = <DT_SIZE_M(8 * 8)>;
			reg = <2>;
			spi-max-frequency = <109000000>;
			/* PSRAM cannot be enabled while board is in default XIP
			 * configuration, as it will conflict with flash chip.
			 */
			status = "disabled";
			cs-interval-unit = <1>;
			cs-interval = <2>;
			cs-hold-time = <3>;
			cs-setup-time = <3>;
			data-valid-time = <6>;
			column-space = <0>;
			ahb-write-wait-unit = <2>;
			ahb-write-wait-interval = <0>;
	};
};
